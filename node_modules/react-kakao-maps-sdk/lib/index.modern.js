import e,{useLayoutEffect as o,useEffect as t,useState as n,useRef as a,useImperativeHandle as r,useContext as i,useMemo as s}from"react";import l from"react-dom";function d(){return d=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},d.apply(this,arguments)}function c(e,o){if(null==e)return{};var t,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o.indexOf(t=r[n])>=0||(a[t]=e[t]);return a}const p="undefined"!=typeof window&&"undefined"!=typeof document?o:t,u=(e,o,t)=>{p(()=>{if(!e||!t)return;const n=(...o)=>void 0===o?t(e):t(e,...o);return kakao.maps.event.addListener(e,o,n),()=>{kakao.maps.event.removeListener(e,o,n)}},[e,o,t])};var k;!function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILURE=3]="FAILURE"}(k||(k={}));class m{constructor({appkey:e,id:o="__reactKakaoMapsSdkloaderId",libraries:t=[],nonce:n,retries:a=3,url:r="//dapi.kakao.com/v2/maps/sdk.js"}){if(this.id=void 0,this.appkey=void 0,this.url=void 0,this.libraries=void 0,this.nonce=void 0,this.retries=void 0,this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=void 0,this.id=o,this.appkey=e,this.libraries=t,this.nonce=n,this.retries=a,this.url=r,m.instance){if(!m.equalOptions(this.options,m.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(m.instance.options)}`);return m.instance}m.instance=this}get options(){return{appkey:this.appkey,id:this.id,libraries:this.libraries,nonce:this.nonce,retries:this.retries,url:this.url}}static isLoaded(){return new Promise(e=>m.instance?m.instance.status===k.FAILURE||m.instance.status===k.INITIALIZED?e(!1):(m.instance.status===k.LOADING&&m.loadcheckcallbacks.push(o=>e(!o)),e(!0)):window.kakao&&window.kakao.maps?0!==window.kakao.maps.readyState?e(!0):window.kakao.maps.load(()=>{e(!0)}):m.loadcheckcallbacks.push(o=>{e(!o)}))}load(){return new Promise((e,o)=>{this.loadCallback(t=>{t?o(t.error):e(window.kakao)})})}get status(){return this.onerrorEvent?k.FAILURE:this.done?k.SUCCESS:this.loading?k.LOADING:k.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}loadCallback(e){this.callbacks.push(e),this.execute()}resetIfRetryingFailed(){this.failed&&this.reset()}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=void 0}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.kakao&&window.kakao.maps)return console.warn("Kakao Maps이 이미 외부 요소에 의해 로딩되어 있습니다.설정한 옵션과 일치 하지 않을 수 있으며, 이에 따른 예상치 동작이 발생할 수 있습니다."),void this.callback();this.loading||(this.loading=!0,this.setScript())}}setScript(){document.getElementById(this.id)&&this.callback();const e=this.createUrl(),o=document.createElement("script");o.id=this.id,o.type="text/javascript",o.src=e,o.onerror=this.loadErrorCallback.bind(this),o.onload=this.callback.bind(this),o.defer=!0,o.async=!0,this.nonce&&(o.nonce=this.nonce),document.head.appendChild(o)}loadErrorCallback(e,o,t,n,a){if(this.errors.push({event:e,source:o,lineno:t,colno:n,error:a}),this.errors.length<=this.retries){const e=this.errors.length*2**this.errors.length;console.log(`Failed to load Kakao Maps script, retrying in ${e} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},e)}else this.onerrorEvent=this.errors[this.errors.length-1],this.callback()}createUrl(){let e=this.url;return e+=`?appkey=${this.appkey}`,this.libraries.length&&(e+=`&libraries=${this.libraries.join(",")}`),e+="&autoload=false",e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}callback(){kakao.maps.load(()=>{this.done=!0,this.loading=!1,this.callbacks.forEach(e=>{e(this.onerrorEvent)}),this.callbacks=[],m.loadcheckcallbacks.forEach(e=>{e(this.onerrorEvent)}),m.loadcheckcallbacks=[]})}static equalOptions(e,o){if(e.appkey!==o.appkey)return!1;if(e.id!==o.id)return!1;if(e.libraries.length!==o.libraries.length)return!1;for(let t=0;t<e.libraries.length;++t)if(e.libraries[t]!==o.libraries[t])return!1;return e.nonce===o.nonce&&e.retries===o.retries&&e.url===o.url}}m.instance=void 0,m.loadcheckcallbacks=[];const g=["as","children","center","isPanto","padding","disableDoubleClick","disableDoubleClickZoom","draggable","zoomable","keyboardShortcuts","level","maxLevel","minLevel","mapTypeId","projectionId","scrollwheel","tileAnimation","onBoundsChanged","onCenterChanged","onClick","onDoubleClick","onDrag","onDragEnd","onDragStart","onIdle","onMaptypeidChanged","onMouseMove","onRightClick","onTileLoaded","onZoomChanged","onZoomStart","onCreate"],h=e.createContext(void 0),w=e.forwardRef((o,t)=>{let{as:i,children:s,center:l,isPanto:k=!1,padding:w=32,disableDoubleClick:v,disableDoubleClickZoom:f,draggable:C,zoomable:y,keyboardShortcuts:b,level:I,maxLevel:M,minLevel:L,mapTypeId:O,projectionId:x,scrollwheel:S,tileAnimation:z,onBoundsChanged:E,onCenterChanged:P,onClick:R,onDoubleClick:A,onDrag:D,onDragEnd:T,onDragStart:Z,onIdle:W,onMaptypeidChanged:N,onMouseMove:j,onRightClick:_,onTileLoaded:F,onZoomChanged:G,onZoomStart:U,onCreate:V}=o,B=c(o,g);const $=i||"div",[q,H]=n(!1),[J,K]=n(),X=a(null);return p(()=>{m.isLoaded().then(H)},[]),p(()=>{if(!q)return;const e=X.current;if(!e)return;const o="lat"in l?new kakao.maps.LatLng(l.lat,l.lng):new kakao.maps.Coords(l.x,l.y),t=new kakao.maps.Map(e,{center:o,disableDoubleClick:v,disableDoubleClickZoom:f,draggable:C,keyboardShortcuts:b,level:I,mapTypeId:O,projectionId:x,scrollwheel:S,tileAnimation:z});return K(t),()=>{e.innerHTML=""}},[q,v,f,O,z]),r(t,()=>J,[J]),p(()=>{J&&V&&V(J)},[J,V]),p(()=>{if(!J)return;let e=J.getCenter();e instanceof kakao.maps.Coords&&(e=e.toLatLng());const o="lat"in l?new kakao.maps.LatLng(l.lat,l.lng):new kakao.maps.Coords(l.x,l.y);o instanceof kakao.maps.LatLng&&o.equals(e)||o instanceof kakao.maps.Coords&&o.toLatLng().equals(e)||(k?J.panTo(o,w):J.setCenter(o))},[J,l.lat,l.lng,l.x,l.y]),p(()=>{J&&void 0!==C&&J.setDraggable(C)},[J,C]),p(()=>{J&&void 0!==y&&J.setZoomable(y)},[J,y]),p(()=>{J&&b&&"boolean"==typeof b&&J.setKeyboardShortcuts(b)},[J,b]),p(()=>{J&&I&&J.setLevel(I)},[J,I]),p(()=>{J&&O&&J.setMapTypeId(O)},[J,O]),p(()=>{J&&x&&J.setProjectionId(x)},[J,x]),p(()=>{J&&M&&J.setMaxLevel(M)},[J,M]),p(()=>{J&&L&&J.setMinLevel(L)},[J,L]),u(J,"bounds_changed",E),u(J,"center_changed",P),u(J,"click",R),u(J,"dblclick",A),u(J,"drag",D),u(J,"dragstart",Z),u(J,"dragend",T),u(J,"idle",W),u(J,"maptypeid_changed",N),u(J,"mousemove",j),u(J,"rightclick",_),u(J,"tilesloaded",F),u(J,"zoom_changed",G),u(J,"zoom_start",U),e.createElement(e.Fragment,null,e.createElement($,d({},B,{ref:X})),J&&e.createElement(h.Provider,{value:J},s))}),v=e=>{const o=i(h);if(!o)throw new Error((e?e+" Component":"useMap")+" must exist inside Map Component!");return o},f=e.forwardRef(({map:e,position:t,marker:n,children:i,altitude:d,disableAutoPan:c,range:p,removable:u,zIndex:k,onCreate:m},g)=>{const h=a(document.createElement("div")),w=s(()=>{const e=new kakao.maps.InfoWindow({altitude:d,disableAutoPan:c,range:p,removable:u,zIndex:k,content:h.current,position:t});return h.current.style.display="none",e},[c,u]);return r(g,()=>w,[w]),o(()=>(w.open(e,n),()=>{w.close()}),[e,n]),o(()=>{m&&m(w)},[w,m]),o(()=>{w&&w.setPosition(t)},[w,t]),o(()=>{w&&d&&w.setAltitude(d)},[w,d]),o(()=>{w&&p&&w.setRange(p)},[w,p]),o(()=>{w&&k&&w.setZIndex(k)},[w,k]),h.current.parentElement&&l.createPortal(i,h.current.parentElement)}),C=e.createContext(void 0),y=e.forwardRef(({children:t,averageCenter:n,calculator:a,clickable:i,disableClickZoom:l,gridSize:d,hoverable:c,minClusterSize:p,minLevel:k,styles:m,texts:g,onClusterclick:h,onClusterdblclick:w,onClustered:f,onClusterout:y,onClusterover:b,onClusterrightclick:I,onCreate:M},L)=>{const O=v("MarkerClusterer"),x=s(()=>{if(window.kakao.maps.MarkerClusterer)return new kakao.maps.MarkerClusterer({averageCenter:n,calculator:a,clickable:i,disableClickZoom:l,gridSize:d,hoverable:c,minClusterSize:p,minLevel:k,styles:m,texts:g});console.warn("clusterer 라이브러리를 별도 로드 해야 사용 가능합니다. `https://apis.map.kakao.com/web/guide/#loadlibrary`")},[]);return r(L,()=>x,[x]),o(()=>{null==x||x.setMap(O)},[O,x]),o(()=>{x&&M&&M(x)},[x,M]),o(()=>{x&&d&&(x.setGridSize(d),x.redraw())},[x,d]),o(()=>{x&&p&&(x.setMinClusterSize(p),x.redraw())},[x,p]),o(()=>{x&&void 0!==n&&(x.setAverageCenter(n),x.redraw())},[x,n]),o(()=>{x&&k&&(x.setMinLevel(k),x.redraw())},[x,k]),o(()=>{x&&g&&(x.setTexts(g),x.redraw())},[x,g]),o(()=>{x&&a&&(x.setCalculator(a),x.redraw())},[x,a]),o(()=>{x&&m&&(x.setStyles(m),x.redraw())},[x,m]),u(x,"clusterclick",h),u(x,"clusterover",b),u(x,"clusterout",y),u(x,"clusterdblclick",w),u(x,"clusterrightclick",I),u(x,"clustered",f),x?e.createElement(C.Provider,{value:x},t):null}),b=e.forwardRef(({map:t,position:n,children:a,altitude:l,clickable:d,draggable:c,image:p,infoWindowOptions:k,onCreate:m,onClick:g,onDragEnd:h,onDragStart:w,onMouseOut:v,onMouseOver:y,opacity:b,range:I,title:M,zIndex:L},O)=>{const x=i(C),S=s(()=>new kakao.maps.Marker({altitude:l,clickable:d,draggable:c,image:p,opacity:b,range:I,title:M,zIndex:L,position:n}),[]);return r(O,()=>S,[S]),o(()=>(x?x.addMarker(S):S.setMap(t),()=>{x?x.removeMarker(S):S.setMap(null)}),[t,x,S]),o(()=>{m&&m(S)},[S,m]),u(S,"click",g),u(S,"dragstart",w),u(S,"dragend",h),u(S,"mouseout",v),u(S,"mouseover",y),o(()=>{t&&S&&n&&S.setPosition(n)},[t,S,n]),o(()=>{t&&S&&p&&S.setImage(p)},[t,S,p]),o(()=>{t&&S&&l&&S.setAltitude(l)},[t,S,l]),o(()=>{t&&S&&void 0!==d&&S.setClickable(d)},[t,S,d]),o(()=>{t&&S&&void 0!==c&&S.setDraggable(c)},[t,S,c]),o(()=>{t&&S&&b&&S.setOpacity(b)},[t,S,b]),o(()=>{t&&S&&I&&S.setRange(I)},[t,S,I]),o(()=>{t&&S&&M&&S.setTitle(M)},[t,S,M]),o(()=>{t&&S&&L&&S.setZIndex(L)},[t,S,L]),a?e.createElement(f,{position:n,map:t,marker:S,altitude:null==k?void 0:k.altitude,disableAutoPan:null==k?void 0:k.disableAutoPan,range:null==k?void 0:k.range,removable:null==k?void 0:k.removable,zIndex:null==k?void 0:k.zIndex},a):null}),I=e.forwardRef(({image:o,position:t,children:n,clickable:a,draggable:r,infoWindowOptions:i,onClick:l,onDragEnd:d,onDragStart:c,onMouseOut:p,onMouseOver:u,onCreate:k,opacity:m,title:g,zIndex:h},w)=>{const f=v("MapMarker"),C=s(()=>{var e,t,n,a,r,i,s,l,d,c,p,u;return o&&new kakao.maps.MarkerImage(o.src,new kakao.maps.Size(o.size.width,o.size.height),{alt:null==(e=o.options)?void 0:e.alt,coords:null==(t=o.options)?void 0:t.coords,offset:(null==(n=o.options)?void 0:n.offset)&&new kakao.maps.Point(null==(a=o.options)?void 0:a.offset.x,null==(r=o.options)?void 0:r.offset.y),shape:null==(i=o.options)?void 0:i.shape,spriteOrigin:(null==(s=o.options)?void 0:s.spriteOrigin)&&new kakao.maps.Point(null==(l=o.options)?void 0:l.spriteOrigin.x,null==(d=o.options)?void 0:d.spriteOrigin.y),spriteSize:(null==(c=o.options)?void 0:c.spriteSize)&&new kakao.maps.Size(null==(p=o.options)?void 0:p.spriteSize.width,null==(u=o.options)?void 0:u.spriteSize.height)})},[o]),y=s(()=>"lat"in t?new kakao.maps.LatLng(t.lat,t.lng):new kakao.maps.Coords(t.x,t.y).toLatLng(),[t.lat,t.lng,t.x,t.y]);return e.createElement(b,{map:f,position:y,image:C,clickable:a,draggable:r,infoWindowOptions:i,onClick:l,onDragEnd:d,onDragStart:c,onMouseOut:p,onMouseOver:u,onCreate:k,opacity:m,title:g,zIndex:h,ref:w},n)}),M=e.forwardRef(({position:o,children:t,disableAutoPan:n,removable:a,zIndex:r,onCreate:i},l)=>{const d=v("MapInfoWindow"),c=s(()=>new kakao.maps.LatLng(o.lat,o.lng),[o.lat,o.lng]);return e.createElement(f,{disableAutoPan:n,removable:a,zIndex:r,map:d,position:c,onCreate:i,ref:l},t)}),L=e.forwardRef(({position:e,children:t,clickable:n,xAnchor:d,yAnchor:c,zIndex:p,onCreate:u},k)=>{const m=i(C),g=v("CustomOverlayMap"),h=a(document.createElement("div")),w=s(()=>new kakao.maps.LatLng(e.lat,e.lng),[e.lat,e.lng]),f=s(()=>{const e=new kakao.maps.CustomOverlay({clickable:n,xAnchor:d,yAnchor:c,zIndex:p,position:w,content:h.current});return h.current.style.display="none",e},[n,d,c]);return r(k,()=>f,[f]),o(()=>{if(g)return m?m.addMarker(f):f.setMap(g),()=>{m?m.removeMarker(f):f.setMap(null)}},[g,m,f]),o(()=>{u&&u(f)},[f,u]),o(()=>{f.setPosition(w)},[f,w]),o(()=>{p&&f.setZIndex(p)},[f,p]),h.current.parentElement&&l.createPortal(t,h.current.parentElement)}),O=e.forwardRef(({position:e=kakao.maps.ControlPosition.TOPRIGHT},t)=>{const n=v("MapTypeControl"),a=s(()=>new kakao.maps.MapTypeControl,[]);return r(t,()=>a,[a]),o(()=>(n.addControl(a,e),()=>{n.removeControl(a)}),[n,a,e]),null}),x=e.forwardRef(({position:e=kakao.maps.ControlPosition.RIGHT},o)=>{const n=v("ZoomControl"),a=s(()=>new kakao.maps.ZoomControl,[]);return r(o,()=>a,[a]),t(()=>(n.addControl(a,e),()=>{n.removeControl(a)}),[n,e]),null}),S=({type:e})=>{const o=v("MapTypeId");return t(()=>(o.addOverlayMapTypeId(e),()=>{o.removeOverlayMapTypeId(e)}),[o,e]),null},z=e.forwardRef(({center:e,radius:t,fillColor:n,fillOpacity:a,strokeColor:i,strokeOpacity:l,strokeStyle:d,strokeWeight:c,zIndex:p,onMouseover:k,onMouseout:m,onMousemove:g,onMousedown:h,onClick:w,onCreate:f},C)=>{const y=v("Circle"),b=s(()=>new kakao.maps.LatLng(e.lat,e.lng),[e.lat,e.lng]),I=s(()=>new kakao.maps.Circle({center:b,radius:t,fillColor:n,fillOpacity:a,strokeColor:i,strokeOpacity:l,strokeStyle:d,strokeWeight:c,zIndex:p}),[]);return r(C,()=>I,[I]),o(()=>(I.setMap(y),()=>{I.setMap(null)}),[y,I]),o(()=>{f&&f(I)},[I,f]),o(()=>{I&&I.setPosition(b)},[I,b]),o(()=>{I.setRadius(t)},[I,t]),o(()=>{p&&I.setZIndex(p)},[I,p]),o(()=>{I.setOptions({fillColor:n,fillOpacity:a,strokeColor:i,strokeOpacity:l,strokeStyle:d,strokeWeight:c})},[I,n,a,i,l,d,c]),u(I,"mouseover",k),u(I,"mouseout",m),u(I,"mousemove",g),u(I,"mousedown",h),u(I,"click",w),null}),E=e.forwardRef(({path:e,endArrow:t,onClick:n,onMousedown:a,onMousemove:i,onMouseout:l,onMouseover:d,onCreate:c,strokeColor:p,strokeOpacity:k,strokeStyle:m,strokeWeight:g,zIndex:h},w)=>{const f=v("Polyline"),C=s(()=>e.every(e=>e instanceof Array)?e.map(e=>e.map(e=>new kakao.maps.LatLng(e.lat,e.lng))):e.map(e=>new kakao.maps.LatLng(e.lat,e.lng)),[e]),y=s(()=>new kakao.maps.Polyline({path:C,endArrow:t,strokeColor:p,strokeOpacity:k,strokeStyle:m,strokeWeight:g,zIndex:h}),[]);return r(w,()=>y,[y]),o(()=>(y.setMap(f),()=>y.setMap(null)),[f,y]),o(()=>{c&&c(y)},[y,c]),o(()=>{y.setOptions({endArrow:t,strokeColor:p,strokeOpacity:k,strokeStyle:m,strokeWeight:g})},[y,t,p,k,m,g]),o(()=>{y.setPath(C)},[y,C]),o(()=>{h&&y.setZIndex(h)},[y,h]),u(y,"mouseover",d),u(y,"mouseout",l),u(y,"mousemove",i),u(y,"mousedown",a),u(y,"click",n),null}),P=e.forwardRef(({path:e,onClick:t,onMousedown:n,onMousemove:a,onMouseout:i,onMouseover:l,onCreate:d,strokeColor:c,strokeOpacity:p,strokeStyle:k,strokeWeight:m,fillColor:g,fillOpacity:h,zIndex:w},f)=>{const C=v("Polygon"),y=s(()=>e.every(e=>e instanceof Array)?e.map(e=>e.map(e=>new kakao.maps.LatLng(e.lat,e.lng))):e.map(e=>new kakao.maps.LatLng(e.lat,e.lng)),[e]),b=s(()=>new kakao.maps.Polygon({path:y,fillColor:g,fillOpacity:h,strokeColor:c,strokeOpacity:p,strokeStyle:k,strokeWeight:m,zIndex:w}),[]);return r(f,()=>b,[b]),o(()=>(b.setMap(C),()=>b.setMap(null)),[C,b]),o(()=>{d&&d(b)},[b,d]),o(()=>{b.setOptions({fillColor:g,fillOpacity:h,strokeColor:c,strokeOpacity:p,strokeStyle:k,strokeWeight:m})},[b,g,h,c,p,k,m]),o(()=>{b.setPath(y)},[b,y]),o(()=>{w&&b.setZIndex(w)},[b,w]),u(b,"mouseover",l),u(b,"mouseout",i),u(b,"mousemove",a),u(b,"mousedown",n),u(b,"click",t),null}),R=e.forwardRef(({bounds:e,onClick:t,onMousedown:n,onMousemove:a,onMouseout:i,onMouseover:l,onCreate:d,strokeColor:c,strokeOpacity:p,strokeStyle:k,strokeWeight:m,fillColor:g,fillOpacity:h,zIndex:w},f)=>{const C=v("Rectangle"),y=s(()=>new kakao.maps.LatLngBounds(new kakao.maps.LatLng(e.sw.lat,e.sw.lng),new kakao.maps.LatLng(e.ne.lat,e.ne.lng)),[e]),b=s(()=>new kakao.maps.Rectangle({bounds:y,fillColor:g,fillOpacity:h,strokeColor:c,strokeOpacity:p,strokeStyle:k,strokeWeight:m,zIndex:w}),[]);return r(f,()=>b,[b]),o(()=>(b.setMap(C),()=>b.setMap(null)),[C,b]),o(()=>{d&&d(b)},[b,d]),o(()=>{b.setOptions({fillColor:g,fillOpacity:h,strokeColor:c,strokeOpacity:p,strokeStyle:k,strokeWeight:m})},[b,g,h,c,p,k,m]),o(()=>{b.setBounds(y)},[b,y]),o(()=>{w&&b.setZIndex(w)},[b,w]),u(b,"mouseover",l),u(b,"mouseout",i),u(b,"mousemove",a),u(b,"mousedown",n),u(b,"click",t),null}),A=e.forwardRef(({center:e,rx:t,ry:n,fillColor:a,fillOpacity:i,strokeColor:l,strokeOpacity:d,strokeStyle:c,strokeWeight:p,zIndex:k,onMouseover:m,onMouseout:g,onMousemove:h,onMousedown:w,onClick:f,onCreate:C},y)=>{const b=v("Ellipse"),I=s(()=>new kakao.maps.LatLng(e.lat,e.lng),[e.lat,e.lng]),M=s(()=>new kakao.maps.Ellipse({center:I,rx:t,ry:n,fillColor:a,fillOpacity:i,strokeColor:l,strokeOpacity:d,strokeStyle:c,strokeWeight:p,zIndex:k}),[]);return r(y,()=>M,[M]),o(()=>(M.setMap(b),()=>{M.setMap(null)}),[b,M]),o(()=>{C&&C(M)},[M,C]),o(()=>{M&&M.setPosition(I)},[M,I]),o(()=>{M.setRadius(t,n)},[M,t,n]),o(()=>{k&&M.setZIndex(k)},[M,k]),o(()=>{M.setOptions({fillColor:a,fillOpacity:i,strokeColor:l,strokeOpacity:d,strokeStyle:c,strokeWeight:p})},[M,a,i,l,d,c,p]),u(M,"mouseover",m),u(M,"mouseout",g),u(M,"mousemove",h),u(M,"mousedown",w),u(M,"click",f),null}),D=e.forwardRef(({draw:e,onAdd:t,onRemove:n,onCreate:a},i)=>{const l=v(),d=s(()=>{class o extends kakao.maps.AbstractOverlay{constructor(e,o,t){super(),this.draw=e,this.onAdd=o,this.onRemove=t}}return new o(e,t,n)},[e,t,n]);return r(i,()=>d,[d]),o(()=>(d.setMap(l),()=>{d.setMap(null)}),[l,d]),o(()=>{a&&a(d)},[d,a]),null}),T=["as","children","position","pan","panoId","panoX","panoY","tilt","zoom","onCreate","onInit","onPanoidChange","onPositionChanged","onViewpointChange","onErrorGetNearestPanoId"],Z=e.createContext(void 0),W=e.forwardRef((o,t)=>{let{as:i,children:s,position:l,pan:k,panoId:g,panoX:h,panoY:w,tilt:v,zoom:f,onCreate:C,onInit:y,onPanoidChange:b,onPositionChanged:I,onViewpointChange:M,onErrorGetNearestPanoId:L}=o,O=c(o,T);const x=i||"div",[S,z]=n(!1),[E,P]=n(!0),[R,A]=n(),D=a(null);return p(()=>{m.isLoaded().then(z)},[]),p(()=>{if(!S)return;const e=D.current;if(!e)return;const o=new kakao.maps.Roadview(e,{pan:k,panoId:g,panoX:h,panoY:w,tilt:v,zoom:f});return A(o),()=>{e.innerHTML=""}},[S,h,w,f]),r(t,()=>R,[R]),p(()=>{R&&C&&C(R)},[R,C]),p(()=>{if(!R||g||R.getPosition().getLat()===l.lat&&R.getPosition().getLng()===l.lng)return;const e=new kakao.maps.LatLng(l.lat,l.lng);(new kakao.maps.RoadviewClient).getNearestPanoId(e,l.radius,o=>{null===o&&L?L(R):R.setPanoId(o,e)})},[R,g,l.lat,l.lng,l.radius,L]),p(()=>{if(!R||!g||g===R.getPanoId()||R.getPosition().getLat()===l.lat&&R.getPosition().getLng()===l.lng)return;const e=new kakao.maps.LatLng(l.lat,l.lng);R.setPanoId(g,e)},[R,g,l.lat,l.lng]),p(()=>{if(!R)return;const e=R.getViewpoint();e.pan===k&&e.tilt===v||(k&&(e.pan=k),v&&(e.tilt=v),R.setViewpoint(e))},[R,k,v]),u(R,"init",e=>{P(!1),y&&y(e)}),u(R,"panoid_changed",b),u(R,"viewpoint_changed",M),u(R,"position_changed",I),e.createElement(e.Fragment,null,e.createElement(x,d({ref:D},O)),R&&!E&&e.createElement(Z.Provider,{value:R},s))}),N=e=>{const o=i(Z);if(!o)throw new Error((e?e+" Component":"useRoadview")+" must exist inside Roadview Component!");return o},j=e.forwardRef(({position:e,children:t,clickable:n,xAnchor:i,yAnchor:d,zIndex:c,altitude:p,range:u,onCreate:k},m)=>{const g=N("CustomOverlayRoadview"),h=a(document.createElement("div")),w=s(()=>"lat"in e?new kakao.maps.LatLng(e.lat,e.lng):new kakao.maps.Viewpoint(e.pan,e.tilt,e.zoom,e.panoId),[e.lat,e.lng,e.pan,e.tilt,e.zoom,e.panoId]),v=s(()=>{const e=new kakao.maps.CustomOverlay({clickable:n,xAnchor:i,yAnchor:d,zIndex:c,position:w,content:h.current});return h.current.style.display="none",e},[n,i,d]);return r(m,()=>v,[v]),o(()=>{if(g)return v.setMap(g),()=>{v.setMap(null)}},[v,g]),o(()=>{k&&k(v)},[v,k]),o(()=>{v.setPosition(w)},[v,w]),o(()=>{c&&v.setZIndex(c)},[v,c]),o(()=>{p&&v.setAltitude(p)},[v,p]),o(()=>{u&&v.setRange(u)},[v,u]),h.current.parentElement&&l.createPortal(t,h.current.parentElement)}),_=e.forwardRef(({image:o,position:t,children:n,altitude:a,clickable:r,infoWindowOptions:i,onClick:l,onDragEnd:d,onDragStart:c,onMouseOut:p,onMouseOver:u,onCreate:k,opacity:m,range:g,title:h,zIndex:w},v)=>{const f=N("RoadviewMarker"),C=s(()=>{var e,t,n,a,r,i,s,l,d,c,p,u;return o&&new kakao.maps.MarkerImage(o.src,new kakao.maps.Size(o.size.width,o.size.height),{alt:null==(e=o.options)?void 0:e.alt,coords:null==(t=o.options)?void 0:t.coords,offset:(null==(n=o.options)?void 0:n.offset)&&new kakao.maps.Point(null==(a=o.options)?void 0:a.offset.x,null==(r=o.options)?void 0:r.offset.y),shape:null==(i=o.options)?void 0:i.shape,spriteOrigin:(null==(s=o.options)?void 0:s.spriteOrigin)&&new kakao.maps.Point(null==(l=o.options)?void 0:l.spriteOrigin.x,null==(d=o.options)?void 0:d.spriteOrigin.y),spriteSize:(null==(c=o.options)?void 0:c.spriteSize)&&new kakao.maps.Size(null==(p=o.options)?void 0:p.spriteSize.width,null==(u=o.options)?void 0:u.spriteSize.height)})},[o]),y=s(()=>"lat"in t?new kakao.maps.LatLng(t.lat,t.lng):"x"in t?new kakao.maps.Coords(t.x,t.y).toLatLng():new kakao.maps.Viewpoint(t.pan,t.tilt,t.zoom,t.panoId),[t.lat,t.lng,t.x,t.y,t.pan,t.tilt,t.zoom,null==t?void 0:t.panoId]);return e.createElement(b,{map:f,position:y,image:C,altitude:a,clickable:r,infoWindowOptions:i,onClick:l,onDragEnd:d,onDragStart:c,onMouseOut:p,onMouseOver:u,onCreate:k,opacity:m,range:g,title:h,zIndex:w,ref:v},n)}),F=e.forwardRef(({position:o,children:t,altitude:n,disableAutoPan:a,range:r,removable:i,zIndex:l,onCreate:d},c)=>{const p=N("RoadviewInfoWindow"),u=s(()=>"lat"in o?new kakao.maps.LatLng(o.lat,o.lng):new kakao.maps.Viewpoint(o.pan,o.tilt,o.zoom,o.panoId),[o.lat,o.lng,o.pan,o.tilt,o.zoom,o.panoId]);return e.createElement(f,{altitude:n,disableAutoPan:a,range:r,removable:i,zIndex:l,map:p,position:u,onCreate:d,ref:c},t)}),G=e.createContext(void 0);function U(e,t,n){o(()=>{e&&n&&e.addListener(t,(...o)=>void 0===o?n(e):n(e,...o))},[n,e,t])}const V=e.forwardRef(function({arrowOptions:t,circleOptions:n,ellipseOptions:a,markerOptions:i,polygonOptions:l,polylineOptions:d,rectangleOptions:c,drawingMode:p,guideTooltip:u,onSelect:k,onDrawstart:m,onDraw:g,onDrawend:h,onDrawnext:w,onCancle:f,onRemove:C,onStateChanged:y,onCreate:b,children:I},M){const L=v("Toolbox"),O=s(()=>{if(window.kakao.maps.drawing)return new kakao.maps.drawing.DrawingManager({map:L,drawingMode:p,guideTooltip:u,arrowOptions:t,circleOptions:n,ellipseOptions:a,markerOptions:i,polygonOptions:l,polylineOptions:d,rectangleOptions:c});console.warn("drawing 라이브러리를 별도 로드 해야 사용 가능합니다. `https://apis.map.kakao.com/web/guide/#loadlibrary`")},[]);return r(M,()=>O,[O]),o(()=>{O&&b&&b(O)},[O,b]),U(O,"select",k),U(O,"drawstart",m),U(O,"draw",g),U(O,"drawend",h),U(O,"drawnext",w),U(O,"cancel",f),U(O,"remove",C),U(O,"state_changed",y),O?e.createElement(G.Provider,{value:O},I):null}),B=e.forwardRef(function({position:e},t){e=e||kakao.maps.ControlPosition.TOP;const n=v("Toolbox"),a=i(G);if(!a)throw new Error("Toolbox must exist inside DrawingManager Component!`");const l=s(()=>new kakao.maps.drawing.Toolbox({drawingManager:a}),[a]);return r(t,()=>l,[l]),o(()=>{const o=l.getElement();return n.addControl(o,e),()=>{n.removeControl(o)}},[n,l,e]),null}),$=e.forwardRef(({id:o="react-kakao-maps-sdk-staticmap-container",style:t,className:i,center:s,marker:l,level:c,mapTypeId:u,onCreate:k},m)=>{const[g,h]=n(),w=a(null);return p(()=>{if(!window.kakao)return void console.warn("kakao map javascript api를 먼저 불러와야 합니다. `https://apis.map.kakao.com/web/guide`");const e=w.current;e&&kakao.maps.load(()=>{const o=Array.isArray(l)?l.map(e=>d({},e,{position:new kakao.maps.LatLng(e.position.lat,e.position.lng)})):"object"==typeof l&&l.position?d({},l,{position:new kakao.maps.LatLng(l.position.lat,l.position.lng)}):l,t=new kakao.maps.StaticMap(e,{center:new kakao.maps.LatLng(s.lat,s.lng),level:c,mapTypeId:u,marker:o});h(t)})},[JSON.stringify(l)]),r(m,()=>g,[g]),p(()=>{g&&g.setCenter(new kakao.maps.LatLng(s.lat,s.lng))},[g,s.lat,s.lng]),p(()=>{g&&c&&g.setLevel(c)},[g,c]),p(()=>{g&&u&&g.setMapTypeId(u)},[g,u]),p(()=>{g&&k&&k(g)},[g,k]),e.createElement("div",{id:o,style:t,className:i,ref:w})}),q=e=>{const[o,a]=n({loading:!0,error:void 0}),r=s(()=>new m(e),[JSON.stringify(e)]);return t(()=>{r.load().then(()=>a({loading:!1,error:void 0})).catch(e=>a({loading:!1,error:e}))},[r]),o};export{D as AbstractOverlay,z as Circle,L as CustomOverlayMap,j as CustomOverlayRoadview,V as DrawingManager,A as Ellipse,m as Loader,w as Map,M as MapInfoWindow,I as MapMarker,O as MapTypeControl,S as MapTypeId,y as MarkerClusterer,P as Polygon,E as Polyline,R as Rectangle,W as Roadview,F as RoadviewInfoWindow,_ as RoadviewMarker,$ as StaticMap,B as Toolbox,x as ZoomControl,q as useInjectKakaoMapApi,v as useMap,N as useRoadview};
//# sourceMappingURL=index.modern.js.map
